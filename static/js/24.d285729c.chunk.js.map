{"version":3,"sources":["views/ggv/NewsEditor/NewsEditor.js"],"names":["JSZip","require","calcAccountId","shareNews","NewsEditor","props","_this","Object","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","content","modules","toolbar","header","font","size","align","color","background","list","indent","clipboard","matchVisual","fee","deadline","price","tags","title","secret","location","author","e","target","value","jszip","file","Date","toLocaleTimeString","generateAsync","type","then","zip","setState","_this2","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","reactstrap__WEBPACK_IMPORTED_MODULE_8__","reactstrap__WEBPACK_IMPORTED_MODULE_9__","htmlFor","reactstrap__WEBPACK_IMPORTED_MODULE_10__","reactstrap__WEBPACK_IMPORTED_MODULE_11__","id","onChange","updateSecret","bind","placeholder","reactstrap__WEBPACK_IMPORTED_MODULE_12__","addonType","reactstrap__WEBPACK_IMPORTED_MODULE_13__","updateTitle","updateTags","updatePrice","updateFee","renderDeadline","react_quill__WEBPACK_IMPORTED_MODULE_6___default","handleChange","reactstrap__WEBPACK_IMPORTED_MODULE_14__","onClick","publishNews","Component"],"mappings":"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","file":"static/js/24.d285729c.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport ReactQuill from 'react-quill';\r\nimport 'react-quill/dist/quill.snow.css';\r\nimport { FormGroup, InputGroup, Label, Input, InputGroupAddon, InputGroupText, Button } from 'reactstrap'\r\nconst JSZip = require(\"jszip\");\r\n\r\nconst { shareNews, calcAccountId } = require('../js/gegeUtil')\r\n//const FileSaver = require('file-saver');\r\n\r\nclass NewsEditor extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { content: 'Edit your content here. 在此编辑要发布的内容.' }\r\n    this.modules = {\r\n      toolbar: [\r\n        [{ 'header': '1' }, { 'header': '2' }, { 'font': [] }],\r\n        [{ size: [] }], [{ align: [] }, 'direction'],\r\n        ['bold', 'italic', 'underline', 'strike', 'blockquote', 'code-block'],\r\n        [{ color: [] }, { background: [] }],\r\n        [{ 'list': 'ordered' }, { 'list': 'bullet' },\r\n        { 'indent': '-1' }, { 'indent': '+1' }],\r\n        ['link', 'image'],\r\n        ['clean']\r\n      ],\r\n      clipboard: {\r\n        // toggle to add extra line breaks when pasting HTML:\r\n        matchVisual: false,\r\n      }\r\n    }\r\n    //\r\n    this.fee = 1;\r\n    this.deadline = 5;\r\n    this.price = 1;\r\n    this.tags = ''\r\n    this.title = ''\r\n    this.secret = ''\r\n    this.location = ''\r\n    this.author = ''\r\n  }\r\n\r\n  updateTitle(e) {\r\n    if (e && e.target) {\r\n      this.title = e.target.value;\r\n    }\r\n  }\r\n\r\n  updateTags(e) {\r\n    if (e && e.target) {\r\n      this.tags = e.target.value;\r\n    }\r\n  }\r\n\r\n  updatePrice(e) {\r\n    if (e && e.target) {\r\n      this.price = e.target.value;\r\n    }\r\n  }\r\n\r\n  updateFee(e) {\r\n    if (e && e.target) {\r\n      this.fee = e.target.value;\r\n    }\r\n  }\r\n\r\n  updateDeadline(e) {\r\n    if (e && e.target) {\r\n      this.deadline = e.target.value;\r\n    }\r\n  }\r\n\r\n  publishNews() {\r\n    //1 save to local file\r\n    //2 start torrent\r\n    var jszip = new JSZip();\r\n    jszip.file('ggvnews.html', this.content);\r\n    jszip.file('title', this.title)\r\n    jszip.file('tags', this.tags)\r\n    jszip.file('price', this.price)\r\n    jszip.file('location', this.location)\r\n    jszip.file('author', this.author)\r\n    jszip.file('time', new Date().toLocaleTimeString())\r\n\r\n    jszip.generateAsync({ type: 'blob' }).then((zip) => {\r\n      //FileSaver.saveAs(zip, \"ggvnews.gnews\");\r\n    })\r\n\r\n    /*\r\n    let news = {};\r\n    shareNews(this.secret,news, (ok) => {\r\n      if (ok) {\r\n\r\n      } else {\r\n\r\n      }\r\n    })\r\n    */\r\n  }\r\n\r\n  updateSecret(e) {\r\n    if (e && e.target) {\r\n      this.secret = e.target.value;\r\n      this.author = calcAccountId(this.secret);\r\n    }\r\n  }\r\n\r\n  handleChange(value) {\r\n    this.setState({ content: value })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"animated fadeIn\">\r\n        <FormGroup>\r\n          <Label htmlFor=\"appendedInputButtons\">眞客账户密码):</Label>\r\n          <div className=\"controls\">\r\n            <InputGroup>\r\n              <Input id=\"appendedInputButtons\" size=\"16\" type=\"text\" onChange={this.updateSecret.bind(this)} placeholder='account secret 输入账户密码發佈资讯' />\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        <FormGroup>\r\n          <div className=\"controls\">\r\n            <InputGroup>\r\n              <InputGroupAddon addonType=\"prepend\">\r\n                <InputGroupText>资讯标题):</InputGroupText>\r\n              </InputGroupAddon>\r\n              <Input id=\"appendedInputButtons\" size=\"16\" type=\"text\" onChange={this.updateTitle.bind(this)} />\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        <FormGroup>\r\n          <div className=\"controls\">\r\n            <InputGroup>\r\n              <InputGroupAddon addonType=\"prepend\">\r\n                <InputGroupText>关键字:</InputGroupText>\r\n              </InputGroupAddon>\r\n              <Input id=\"appendedInputButtons\" size=\"16\" type=\"text\" onChange={this.updateTags.bind(this)} />\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        <FormGroup>\r\n          <div className=\"controls\">\r\n            <InputGroup className=\"input-prepend\">\r\n              <InputGroupAddon addonType=\"prepend\">\r\n                <InputGroupText>价格:</InputGroupText>\r\n              </InputGroupAddon>\r\n              <Input id=\"appendedPrependedInput3\" size=\"16\" type=\"text\" onChange={this.updatePrice.bind(this)} placeholder=' 资讯价格,默认 1 积分' />\r\n              <InputGroupAddon addonType=\"append\">\r\n                <InputGroupText>积分</InputGroupText>\r\n              </InputGroupAddon>\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        <FormGroup>\r\n          <div className=\"controls\">\r\n            <InputGroup className=\"input-prepend\">\r\n              <InputGroupAddon addonType=\"prepend\">\r\n                <InputGroupText>机器人费:</InputGroupText>\r\n              </InputGroupAddon>\r\n              <Input id=\"appendedPrependedInput\" size=\"16\" type=\"text\" onChange={this.updateFee.bind(this)} placeholder='机器人手续费,最少0.1积分' />\r\n              <InputGroupAddon addonType=\"append\">\r\n                <InputGroupText>积分</InputGroupText>\r\n              </InputGroupAddon>\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        {\r\n          this.renderDeadline()\r\n        }\r\n        <FormGroup>\r\n          <Label htmlFor=\"appendedInputButtons\">正文:</Label>\r\n          <ReactQuill value={this.state.content}\r\n            modules={this.modules}\r\n            onChange={this.handleChange.bind(this)} />\r\n        </FormGroup>\r\n        <Button type=\"submit\" color=\"primary\" onClick={(e) => this.publishNews()}>发布内容</Button>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  renderDeadline() {\r\n    if (true)\r\n      return null;\r\n    return (<FormGroup>\r\n      <div className=\"controls\">\r\n        <InputGroup className=\"input-prepend\">\r\n          <InputGroupAddon addonType=\"prepend\">\r\n            <InputGroupText>有效期:</InputGroupText>\r\n          </InputGroupAddon>\r\n          <Input id=\"appendedPrependedInput\" size=\"16\" onChange={this.updateDeadline.bind(this)} type=\"text\" placeholder='deadline 5minutes by default,交易有效期，默认5分钟' />\r\n          <InputGroupAddon addonType=\"append\">\r\n            <InputGroupText>分钟</InputGroupText>\r\n          </InputGroupAddon>\r\n        </InputGroup>\r\n      </div>\r\n    </FormGroup>)\r\n  }\r\n}\r\n\r\nexport default NewsEditor;\r\n"],"sourceRoot":""}