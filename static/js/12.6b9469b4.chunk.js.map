{"version":3,"sources":["views/ggv/js/share.js","../node_modules/webpack/buildin/harmony-module.js","../node_modules/reactstrap/es/ListGroupItemHeading.js","../node_modules/reactstrap/es/ListGroupItemText.js","views/ggv/FileTransfer/FileTransfer.js"],"names":["WebTorrent","require","ShareManager","Object","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","client","tracker","rtcConfig","iceServers","urls","dht","torrentCallback","onStartCallback","uploadInput","up","document","querySelector","uploadElement","err","files","map","file","onFiles","bind","name","indexOf","isTorrentFile","torrent","on","warn","console","log","content","buf","Buffer","from","tor","seed","infoHash","_this","length","setTimeout","onSeedTorrent","forEach","elem","opts","cb","type","addEventListener","ev","reader","FileReader","index","results","read","readAsText","readAsDataURL","readAsArrayBuffer","e","push","target","module","exports","originalModule","webpackPolyfill","create","children","defineProperty","enumerable","get","l","i","_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_2__","react__WEBPACK_IMPORTED_MODULE_2___default","n","prop_types__WEBPACK_IMPORTED_MODULE_3__","prop_types__WEBPACK_IMPORTED_MODULE_3___default","classnames__WEBPACK_IMPORTED_MODULE_4__","classnames__WEBPACK_IMPORTED_MODULE_4___default","_utils__WEBPACK_IMPORTED_MODULE_5__","propTypes","tag","className","a","any","cssModule","object","ListGroupItemHeading","props","Tag","attributes","classes","createElement","defaultProps","__webpack_exports__","ListGroupItemText","getCurrentHost","startPlayer","randombytes","FileTransfer","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","resourceList","download","loadingMsg","showqr","qrName","shareMsg","share","tags","resName","resId","infoInterval","torrentList","hash","window","location","query","idx","substr","idx2","setState","startDownload","init","onTorrentDone","onTorrentStart","secret","url","getShareHost","concat","json","r","data","ok","toString","id","num","exponent","neg","units","Math","min","floor","Number","pow","toFixed","_this2","peersSpan","speedSpan","innerHTML","numPeers","prettyBytes","uploadSpeed","magnetURI","torrentFileBlobURL","rlist","key","unshift","setInterval","updateTorrentStatus","react__WEBPACK_IMPORTED_MODULE_5___default","reactstrap__WEBPACK_IMPORTED_MODULE_6__","reactstrap__WEBPACK_IMPORTED_MODULE_7__","xs","reactstrap__WEBPACK_IMPORTED_MODULE_17__","reactstrap__WEBPACK_IMPORTED_MODULE_8__","reactstrap__WEBPACK_IMPORTED_MODULE_9__","reactstrap__WEBPACK_IMPORTED_MODULE_12__","color","reactstrap__WEBPACK_IMPORTED_MODULE_18__","isOpen","reactstrap__WEBPACK_IMPORTED_MODULE_10__","reactstrap__WEBPACK_IMPORTED_MODULE_19__","reactstrap__WEBPACK_IMPORTED_MODULE_13__","reactstrap__WEBPACK_IMPORTED_MODULE_14__","addonType","reactstrap__WEBPACK_IMPORTED_MODULE_15__","reactstrap__WEBPACK_IMPORTED_MODULE_16__","showQRDialog","resid","addr","focus","select","successful","execCommand","msg","_this3","res","pid","sid","reactstrap__WEBPACK_IMPORTED_MODULE_20__","action","reactstrap__WEBPACK_IMPORTED_MODULE_21__","onClick","showBarcode","copyAddress","readOnly","style","width","value","reactstrap__WEBPACK_IMPORTED_MODULE_22__","sm","xl","reactstrap__WEBPACK_IMPORTED_MODULE_23__","renderResourceItems","reactstrap__WEBPACK_IMPORTED_MODULE_24__","reactstrap__WEBPACK_IMPORTED_MODULE_25__","toggle","reactstrap__WEBPACK_IMPORTED_MODULE_26__","reactstrap__WEBPACK_IMPORTED_MODULE_11__","renderPlayer","renderAddFile","renderShareList","Component"],"mappings":"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","file":"static/js/12.6b9469b4.chunk.js","sourcesContent":["const WebTorrent = require('flycat-torrent')\r\n\r\nclass ShareManager {\r\n\r\n    constructor() {\r\n        let rtcConfig = {\r\n            \"iceServers\": [\r\n                { \"urls\": \"stun:stun2.l.google.com:19302\" },\r\n                { \"urls\": \"stun:stun3.l.google.com:19302\" },\r\n                { \"urls\": \"stun:stun.btbresource.com:3478\" },\r\n                {\r\n                    \"urls\": \"stun:global.stun.twilio.com:3478?transport=udp\"\r\n                }\r\n            ]\r\n        };\r\n        this.client = new WebTorrent({\r\n            tracker: {\r\n                rtcConfig: rtcConfig\r\n            },\r\n            dht: false\r\n        })\r\n        this.torrentCallback = null\r\n        this.onStartCallback = null\r\n    }\r\n\r\n    init(torrentCallback, onStartCallback, uploadInput) {\r\n        this.torrentCallback = torrentCallback;\r\n        this.onStartCallback = onStartCallback;\r\n        var up = uploadInput;\r\n        if (!up)\r\n            up = document.querySelector('input[name=upload]')\r\n        if (up) {\r\n            this.uploadElement(up, this.onStartCallback, (function (err, files) {\r\n                if (err) return err;\r\n                files = files.map(function (file) { return file.file })\r\n                this.onFiles(files)\r\n            }).bind(this))\r\n        }\r\n    }\r\n\r\n    isTorrentFile(file) {\r\n        //var extname = path.extname(file.name).toLowerCase()\r\n        return file.name.indexOf('.torrent') !== -1;\r\n    }\r\n\r\n    isNotTorrentFile(file) {\r\n        return !this.isTorrentFile(file)\r\n    }\r\n\r\n    onSeedTorrent(torrent) {\r\n        torrent.on('warning', function (warn) {\r\n            console.log(warn);\r\n        })\r\n        torrent.on('error', function (err) {\r\n            console.log(err);\r\n        })\r\n        this.torrentCallback(torrent);\r\n    }\r\n\r\n    seedContent(content,torrentCallback) {\r\n        let buf = Buffer.from(content)\r\n        let tor = this.client.seed(buf, torrentCallback);\r\n        tor.on('infoHash', (infoHash) => {\r\n            torrentCallback(tor);\r\n        })\r\n    }\r\n\r\n    seed(files) {\r\n        if (files.length === 0) return\r\n        //console.log('Seeding ' + files.length + ' files')\r\n        this.onStartCallback(files)\r\n        // Seed from WebTorrent\r\n        setTimeout(() => {\r\n            let tor = this.client.seed(files, this.onSeedTorrent.bind(this));\r\n            tor.on('infoHash', (infoHash) => {\r\n                this.torrentCallback(tor);\r\n            })\r\n        }, 1000);\r\n    }\r\n    //\r\n    onFiles(files) {\r\n        console.log('got files:')\r\n        files.forEach(function (file) {\r\n            // console.log(' - %s (%s bytes)', file.name, file.size)\r\n        })\r\n\r\n        // .torrent file = start downloading the torrent\r\n        //files.filter(isTorrentFile).forEach(downloadTorrentFile)\r\n\r\n        // everything else = seed these files\r\n        this.seed(files)\r\n    }\r\n\r\n    uploadElement(elem, onStartCallback, opts, cb) {\r\n        if (typeof opts === 'function') {\r\n            cb = opts;\r\n            opts = {};\r\n        }\r\n        if (typeof opts === 'string') opts = { type: opts };\r\n\r\n        elem.addEventListener('change', function (ev) {\r\n            if (elem.files.length === 0) return cb(null, []);\r\n            if (onStartCallback)\r\n                onStartCallback(null)\r\n            var reader = new FileReader();\r\n            var index = 0;\r\n            var results = [];\r\n\r\n            reader.addEventListener('load', function (e) {\r\n                results.push({\r\n                    file: elem.files[index],\r\n                    target: e.target\r\n                });\r\n                index++;\r\n                if (index === elem.files.length) cb(null, results)\r\n                else read(index)\r\n            });\r\n            read(index);\r\n\r\n            function read(index) {\r\n                var file = elem.files[index];\r\n                if (opts.type === 'text') {\r\n                    reader.readAsText(file);\r\n                }\r\n                else if (opts.type === 'url') {\r\n                    reader.readAsDataURL(file);\r\n                }\r\n                else reader.readAsArrayBuffer(file);\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n\r\nmodule.exports = ShareManager;","module.exports = function (originalModule) {\n  if (!originalModule.webpackPolyfill) {\n    var module = Object.create(originalModule); // module.parent = undefined by default\n\n    if (!module.children) module.children = [];\n    Object.defineProperty(module, \"loaded\", {\n      enumerable: true,\n      get: function get() {\n        return module.l;\n      }\n    });\n    Object.defineProperty(module, \"id\", {\n      enumerable: true,\n      get: function get() {\n        return module.i;\n      }\n    });\n    Object.defineProperty(module, \"exports\", {\n      enumerable: true\n    });\n    module.webpackPolyfill = 1;\n  }\n\n  return module;\n};","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { mapToCssModules, tagPropType } from './utils';\nvar propTypes = {\n  tag: tagPropType,\n  className: PropTypes.any,\n  cssModule: PropTypes.object\n};\nvar defaultProps = {\n  tag: 'h5'\n};\n\nvar ListGroupItemHeading = function ListGroupItemHeading(props) {\n  var className = props.className,\n      cssModule = props.cssModule,\n      Tag = props.tag,\n      attributes = _objectWithoutPropertiesLoose(props, [\"className\", \"cssModule\", \"tag\"]);\n\n  var classes = mapToCssModules(classNames(className, 'list-group-item-heading'), cssModule);\n  return React.createElement(Tag, _extends({}, attributes, {\n    className: classes\n  }));\n};\n\nListGroupItemHeading.propTypes = propTypes;\nListGroupItemHeading.defaultProps = defaultProps;\nexport default ListGroupItemHeading;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { mapToCssModules, tagPropType } from './utils';\nvar propTypes = {\n  tag: tagPropType,\n  className: PropTypes.any,\n  cssModule: PropTypes.object\n};\nvar defaultProps = {\n  tag: 'p'\n};\n\nvar ListGroupItemText = function ListGroupItemText(props) {\n  var className = props.className,\n      cssModule = props.cssModule,\n      Tag = props.tag,\n      attributes = _objectWithoutPropertiesLoose(props, [\"className\", \"cssModule\", \"tag\"]);\n\n  var classes = mapToCssModules(classNames(className, 'list-group-item-text'), cssModule);\n  return React.createElement(Tag, _extends({}, attributes, {\n    className: classes\n  }));\n};\n\nListGroupItemText.propTypes = propTypes;\nListGroupItemText.defaultProps = defaultProps;\nexport default ListGroupItemText;","import React, { Component } from 'react';\r\nimport { Badge, Card, CardBody, CardHeader, Col, Row } from 'reactstrap';\r\nimport { Button, InputGroup, InputGroupAddon, InputGroupText, Alert } from 'reactstrap';\r\nimport { FormGroup, Fade, Collapse, ListGroup, ListGroupItem, ListGroupItemHeading, ListGroupItemText } from 'reactstrap'\r\nimport { Modal, ModalBody, ModalHeader } from 'reactstrap'\r\nimport { getShareHost, showQRDialog } from '../js/gegeUtil.js'\r\n\r\nconst ShareManager = require('../js/share')\r\nconst get = require('simple-get')\r\nconst { getCurrentHost, startPlayer } = require('../js/gegeUtil')\r\nvar randombytes = require('randombytes')\r\n\r\nclass FileTransfer extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { resourceList: [], download: null, loadingMsg: '(下载中) ...', showqr: false, qrName: '' }\r\n        this.state.shareMsg = '';\r\n        this.share = new ShareManager(this.state);\r\n        /*\r\n        this.userSec = window.sessionStorage.getItem(\"userSec\");\r\n        if (!this.userSec) {\r\n          this.userSec = window.localStorage.getItem(\"userSec\");\r\n        }\r\n        */\r\n        this.tags = ''\r\n        this.resName = ''\r\n        this.resId = ''\r\n        this.infoInterval = null\r\n        this.torrentList = []\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        let hash = window.location.hash;\r\n        let query = null;\r\n        let name = null;\r\n        if (hash) {\r\n            let idx = hash.indexOf(\"#\", 1);\r\n            if (idx > 0) {\r\n                //\r\n                query = hash.substr(idx + 1, 64);\r\n                let idx2 = hash.indexOf(\"#\", idx + 64); {\r\n                    if (idx2 > 0) {\r\n                        name = hash.substr(idx2 + 1);\r\n                    }\r\n                }\r\n                // console.log('query=' + query + \" name=\" + name);\r\n                if (query && query.length == 64) {\r\n                    if (name) {\r\n                        //name = Url.decode(name);\r\n                        this.setState({ download: name })\r\n                    } else {\r\n                        this.setState({ download: query })\r\n                    }\r\n                    this.startDownload(null, query);\r\n                }\r\n            }\r\n        }\r\n        this.share.init(this.onTorrentDone.bind(this), this.onTorrentStart.bind(this))\r\n    }\r\n\r\n    startDownload(secret, resId) {\r\n        var url = getShareHost() + \"/btb?action=p2pTransfer&resId=\" + resId;\r\n\r\n        get.concat({ url: url, json: true }, (function (err, r, data) {\r\n            if (err) {\r\n                //console.log(err);\r\n                this.setState({ shareMsg: 'err.出错了' });\r\n                return;\r\n            }\r\n            if (data.ok) {\r\n                //ok to play\r\n                let pid = '1234567890' + randombytes(15).toString('hex')\r\n                startPlayer(secret, { id: resId, tags: '' });\r\n            } else {\r\n                this.setState({ shareMsg: '不是免费资源' });\r\n            }\r\n        }).bind(this))\r\n    }\r\n\r\n    prettyBytes(num) {\r\n        var exponent, unit, neg = num < 0, units = ['B', 'kB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\r\n        if (neg) num = -num\r\n        if (num < 1) return (neg ? '-' : '') + num + ' B'\r\n        exponent = Math.min(Math.floor(Math.log(num) / Math.log(1000)), units.length - 1)\r\n        num = Number((num / Math.pow(1000, exponent)).toFixed(2))\r\n        unit = units[exponent]\r\n        return (neg ? '-' : '') + num + ' ' + unit\r\n    }\r\n\r\n    updateTorrentStatus() {\r\n        //console.log('size ' + this.torrentList.length)\r\n        this.torrentList.map((torrent) => {\r\n            //uploadSpeed peers\r\n            let peersSpan = document.querySelector('#pid' + torrent.infoHash);\r\n            let speedSpan = document.querySelector('#sid' + torrent.infoHash);\r\n            if (peersSpan)\r\n                peersSpan.innerHTML = torrent.numPeers;\r\n            if (speedSpan)\r\n                speedSpan.innerHTML = this.prettyBytes(torrent.uploadSpeed) + '/s';\r\n        })\r\n    }\r\n\r\n    onTorrentStart() {\r\n        this.setState({ shareMsg: '处理中...' })\r\n    }\r\n\r\n    onTorrentDone(torrent) {\r\n        if (torrent) {\r\n            var info = 'Torrent info hash: ' + torrent.infoHash +\r\n                'magnetURI=' + torrent.magnetURI +\r\n                ' torrentFileBlobURL=\"' + torrent.torrentFileBlobURL + 'name=' + torrent.name;\r\n            //console.log(info);\r\n            this.resId = torrent.infoHash\r\n            this.resName = torrent.name;\r\n            var rlist = this.state.resourceList;\r\n            rlist.push({ id: this.resId, name: this.resName })\r\n            this.setState({ resourceList: rlist })\r\n            torrent.key = torrent.infoHash;\r\n            //tags is not set yet\r\n            //torrent.tags = this.tags;\r\n            this.torrentList.unshift(torrent)\r\n        }\r\n        if (!this.infoInterval) {\r\n            this.infoInterval = setInterval(this.updateTorrentStatus.bind(this), 3000);\r\n        }\r\n        this.setState({ shareMsg: '' })\r\n    }\r\n\r\n\r\n    renderAddFile() {\r\n        return (<Row>\r\n            <Col xs=\"12\">\r\n                <Fade>\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <i className=\"icon-share\">点对点文件传输</i>\r\n                            <div className=\"card-header-actions\">\r\n                                <Button color=\"link\" className=\"card-header-action btn-setting\"><i className=\"icon-settings\"></i></Button>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <Collapse isOpen={true} id=\"collapseExample\">\r\n                            <CardBody>\r\n                                <div>\r\n                                    <p>选择要传输的文件,直接发送给好友，支持手机与电脑之间高速文件传输.</p>\r\n                                </div>\r\n                                <FormGroup>\r\n                                    <div className=\"controls\">\r\n                                        <InputGroup className=\"input-prepend\">\r\n                                            <InputGroupAddon addonType=\"prepend\">\r\n                                                <InputGroupText>Resource(资源):</InputGroupText>\r\n                                            </InputGroupAddon>\r\n                                            <input name=\"upload\" type=\"file\"></input>\r\n                                        </InputGroup>\r\n                                    </div>\r\n                                </FormGroup>\r\n                                <div>\r\n                                    <p><Alert color=\"danger\"><small>{this.state.shareMsg}</small></Alert></p>\r\n                                </div>\r\n                            </CardBody>\r\n                        </Collapse>\r\n                    </Card>\r\n                </Fade>\r\n            </Col>\r\n        </Row>)\r\n    }\r\n\r\n    showBarcode(resId, resName) {\r\n        this.setState({ showqr: true, qrName: resName });\r\n        var url = getCurrentHost() + \"/#/fly#\" + resId + '#' + resName;\r\n        setTimeout(() => {\r\n            showQRDialog(url);\r\n        }, 1500);\r\n    }\r\n\r\n    copyAddress(resid) {\r\n        let addr = document.querySelector('#url_' + resid);\r\n        addr.focus()\r\n        addr.select()\r\n        var successful = document.execCommand('copy');\r\n        let msg = document.querySelector('#msg_' + resid);\r\n        if (successful) {\r\n            msg.innerHTML = 'OK.复制成功'\r\n        } else {\r\n            msg.innerHTML = '复制失败，请手动复制'\r\n        }\r\n    }\r\n\r\n    renderResourceItems() {\r\n        let items = this.state.resourceList.map((res) => {\r\n            let pid = 'pid' + res.id;\r\n            let sid = 'sid' + res.id;\r\n            return (<ListGroupItem key={res.id} action>\r\n                <ListGroupItemHeading> <i className=\"fa fa-barcode\" onClick={(e) => this.showBarcode(res.id, res.name)}></i><span> {res.name} : 请将下面地址发给好友下载</span>\r\n                    <Button color=\"ghost-success\" onClick={(e) => this.copyAddress(res.id)}>\r\n                        <i className=\"fa fa-copy fa-lg\"></i>&nbsp;复制地址\r\n        </Button>\r\n                    <span className='alert-primary' id={'msg_' + res.id}></span>\r\n                </ListGroupItemHeading>\r\n                <ListGroupItemHeading><input readOnly style={{ width: '100%' }} id={'url_' + res.id} value={getCurrentHost() + \"/#/fly#\" + res.id + '#' + res.name}></input></ListGroupItemHeading>\r\n                <ListGroupItemText>\r\n                    <code> <span id={pid}></span>节点</code>. &#x2197;<code><span id={sid}></span>上传速度</code>\r\n                </ListGroupItemText>\r\n            </ListGroupItem>)\r\n        })\r\n        return items;\r\n    }\r\n\r\n    toggle() {\r\n        this.setState({ showqr: !this.state.showqr })\r\n    }\r\n\r\n    renderShareList() {\r\n        return (<Row>\r\n            <Col sm=\"12\" xl=\"6\">\r\n                <Card>\r\n                    <CardHeader>\r\n                        <i className=\"fa fa-align-justify\"></i><strong>Transfer List(传输列表</strong>\r\n                        <Alert color=\"danger\"><small>资源不会上传给任何服务器，点对点直接从本地下载。Please keep this page open.请不要刷新或关闭此页面，保持此页面打开状态下，文件传输才能正常工作。页面异常情况可以重新选择文件继续传输。</small></Alert>\r\n                    </CardHeader>\r\n                    <CardBody>\r\n                        <ListGroup>\r\n                            {this.renderResourceItems()}\r\n                        </ListGroup>\r\n                        <Modal isOpen={this.state.showqr} className={this.props.className}>\r\n                            <ModalHeader toggle={this.toggle.bind(this)}>{this.state.qrName}</ModalHeader>\r\n                            <ModalBody>\r\n                                <div id=\"qrcode\"></div>\r\n                            </ModalBody>\r\n                        </Modal>\r\n                    </CardBody>\r\n                </Card>\r\n            </Col>\r\n        </Row>)\r\n    }\r\n\r\n    renderPlayer() {\r\n        if (!this.state.download)\r\n            return null;\r\n        return (\r\n            <div id=\"playdiv\">\r\n                <Card>\r\n                    <CardHeader>\r\n                        {this.state.download}\r\n                        <Badge color=\"success\" className=\"float-right\">{this.state.loadingMsg}</Badge>\r\n                    </CardHeader>\r\n                    <CardBody>\r\n                        <div id=\"status\">\r\n                            <div>\r\n                                <span className=\"show-leech\"> from </span>\r\n                                <code id=\"numPeers\">0 peers</code>.\r\n                            <code id=\"downloadSpeed\">0 b/s </code> / &#x2197;\r\n                            <code id=\"uploadSpeed\">0 b/s - </code>\r\n                                <code id=\"downloaded\"></code> of\r\n                            <code id=\"total\"></code> —\r\n                            <span id=\"remaining\"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div id=\"player\" style={{ width: '100%' }}>\r\n                        </div>\r\n                    </CardBody>\r\n                </Card>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"animated fadeIn\">\r\n                {this.renderPlayer()}\r\n                {this.renderAddFile()}\r\n                {this.renderShareList()}\r\n\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nexport default FileTransfer;\r\n"],"sourceRoot":""}