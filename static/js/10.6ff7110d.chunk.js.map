{"version":3,"sources":["views/ggv/NewsWeb/NewsWeb.js"],"names":["NewsWeb","require","props","_this","Object","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","E_working_dir_flycat_flycat_portal_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","call","page","state","list","count","paying","fee","deadline","hash","window","location","query","title","idx","indexOf","needPay","substr","decodeURIComponent","setState","setTimeout","account","loadLocalAccount","secret","Date","toDateString","Math","random","startPlayer","id","tags","peerId","newsId","document","querySelector","url","getFileHost","innerHTML","_this2","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","reactstrap__WEBPACK_IMPORTED_MODULE_15__","isOpen","toggle","togglePurchase","bind","className","reactstrap__WEBPACK_IMPORTED_MODULE_16__","reactstrap__WEBPACK_IMPORTED_MODULE_17__","reactstrap__WEBPACK_IMPORTED_MODULE_18__","reactstrap__WEBPACK_IMPORTED_MODULE_19__","reactstrap__WEBPACK_IMPORTED_MODULE_20__","addonType","reactstrap__WEBPACK_IMPORTED_MODULE_21__","reactstrap__WEBPACK_IMPORTED_MODULE_22__","size","type","value","_conponents_PopHint_PopHint__WEBPACK_IMPORTED_MODULE_24__","text","content","onChange","placeholder","renderDeadline","purchaseMsg","reactstrap__WEBPACK_IMPORTED_MODULE_10__","color","onClick","e","doPurchase","reactstrap__WEBPACK_IMPORTED_MODULE_11__","href","style","width","iframe","reactstrap__WEBPACK_IMPORTED_MODULE_7__","reactstrap__WEBPACK_IMPORTED_MODULE_8__","renderPayButton","renderPurchaseDialog","reactstrap__WEBPACK_IMPORTED_MODULE_9__","renderPlayer","renderIframe","Component"],"mappings":"2bAUMA,UAHMC,EAAQ,IACAA,EAAQ,IACTA,EAAQ,iBAGzB,SAAAD,EAAYE,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAN,IACjBG,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAJ,GAAAS,KAAAH,KAAMJ,KACDQ,KAAO,EACZP,EAAKQ,MAAQ,CAAEC,KAAM,GAAIF,KAAM,EAAGG,MAAO,EAAGC,QAAQ,EAAOC,IAAK,IAAKC,SAAU,KAH9Db,mFAOjB,IAAIc,EAAOC,OAAOC,SAASF,KACvBG,EAAQ,KACRC,EAAQ,GACZ,GAAIJ,EAAM,CACR,IAAIK,EAAML,EAAKM,QAAQ,IAAK,GAC5B,GAAID,EAAM,EAAG,CACX,IAAIE,EAAUP,EAAKQ,OAAOH,EAAM,GAAI,GACpCD,EAAQJ,EAAKQ,OAAOH,EAAM,KAC1BD,EAAQK,mBAAmBL,KAEzBf,KAAKqB,SAAS,CAAEN,QAAOG,aAGzBF,GADAF,EAAQH,EAAKQ,OAAOH,EAAM,EAAG,KACjBC,QAAQ,IAAK,IACf,IACRH,EAAQA,EAAMK,OAAO,EAAGH,KAK9BM,WAAW,WACT,IAAIC,EAAUC,6BACTD,IACHA,EAAU,CAAEE,OAAQ,aAAc,IAAIC,MAAOC,eAAiB,IAAMC,KAAKC,WAE3EC,sBAAYP,EAAQE,OAAQ,CAAEM,GAAIjB,EAAOkB,KAAMjB,EAAQ,WACtD,wCAGMkB,EAAQC,GACjB,IAAI9B,EAAO+B,SAASC,cAAc,WAC9BC,EAAMC,wBAAgB,SAAWL,EAAS,IAAMC,EAChDlC,KAAKK,MAAMa,UACbmB,EAAMC,wBAAgB,WAAaL,EAAS,IAAMC,GAEpD9B,EAAKmC,UAAY,yEAA2EF,EAAM,gDAIlGrC,KAAKqB,SAAS,CAAEb,QAASR,KAAKK,MAAMG,8FAOf,IAAAgC,EAAAxC,KACrB,OAAQyC,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAOC,OAAQ7C,KAAKK,MAAMG,OAAQsC,OAAQ9C,KAAK+C,eAAeC,KAAKhD,MACzEiD,UAAW,cAAgBjD,KAAKJ,MAAMqD,WACtCR,EAAAC,EAAAC,cAACO,EAAA,EAAD,CAAaJ,OAAQ9C,KAAK+C,eAAeC,KAAKhD,OAA9C,8CACAyC,EAAAC,EAAAC,cAACQ,EAAA,EAAD,KACEV,EAAAC,EAAAC,cAACS,EAAA,EAAD,KACEX,EAAAC,EAAAC,cAAA,OAAKM,UAAU,YACbR,EAAAC,EAAAC,cAACU,EAAA,EAAD,CAAYJ,UAAU,iBACpBR,EAAAC,EAAAC,cAACW,EAAA,EAAD,CAAiBC,UAAU,WACzBd,EAAAC,EAAAC,cAACa,EAAA,EAAD,KAAiBxD,KAAKK,MAAMU,WAKpC0B,EAAAC,EAAAC,cAACS,EAAA,EAAD,KACEX,EAAAC,EAAAC,cAAA,OAAKM,UAAU,YACbR,EAAAC,EAAAC,cAACU,EAAA,EAAD,CAAYJ,UAAU,iBACpBR,EAAAC,EAAAC,cAACW,EAAA,EAAD,CAAiBC,UAAU,WACzBd,EAAAC,EAAAC,cAACa,EAAA,EAAD,uBAEFf,EAAAC,EAAAC,cAACc,EAAA,EAAD,CAAO1B,GAAG,yBAAyB2B,KAAK,KAAKC,KAAK,OAAOC,MAAO,IAChEnB,EAAAC,EAAAC,cAACW,EAAA,EAAD,CAAiBC,UAAU,UACzBd,EAAAC,EAAAC,cAACa,EAAA,EAAD,yBAKRf,EAAAC,EAAAC,cAACS,EAAA,EAAD,KACEX,EAAAC,EAAAC,cAAA,OAAKM,UAAU,YACbR,EAAAC,EAAAC,cAACU,EAAA,EAAD,CAAYJ,UAAU,iBACpBR,EAAAC,EAAAC,cAACW,EAAA,EAAD,CAAiBC,UAAU,WACzBd,EAAAC,EAAAC,cAACa,EAAA,EAAD,KAAgBf,EAAAC,EAAAC,cAACkB,EAAA,EAAD,CAAS9B,GAAG,SAAS+B,KAAK,4BAAQC,QAAQ,kbAE5DtB,EAAAC,EAAAC,cAACc,EAAA,EAAD,CAAO1B,GAAG,yBAAyB2B,KAAK,KAAKC,KAAK,OAAOK,SAAU,SAACvD,GAAD,OAAS+B,EAAKnB,SAAS,CAAEZ,SAAQwD,YAAY,wDAChHxB,EAAAC,EAAAC,cAACW,EAAA,EAAD,CAAiBC,UAAU,UACzBd,EAAAC,EAAAC,cAACa,EAAA,EAAD,yBAMNxD,KAAKkE,iBAEPzB,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,SAAI3C,KAAKK,MAAM8D,cAEjB1B,EAAAC,EAAAC,cAAA,OAAKM,UAAU,gBACbR,EAAAC,EAAAC,cAACyB,EAAA,EAAD,CAAQT,KAAK,SAASU,MAAM,UAAUC,QAAS,SAACC,GAAD,OAAO/B,EAAKgC,eAA3D,gBACA/B,EAAAC,EAAAC,cAACyB,EAAA,EAAD,CAAQC,MAAM,YAAYC,QAAS,SAACC,GAAD,OAAO/B,EAAKO,mBAA/C,4DAQJ,OAAO,+CAiBT,OAA0B,GAAtB/C,KAAKK,MAAMa,QACN,KACDuB,EAAAC,EAAAC,cAAC8B,EAAA,EAAD,CAAOJ,MAAM,WAAb,2JAAkD5B,EAAAC,EAAAC,cAAA,KAAG+B,KAAK,8CAAR,sEAAlD,4CAIR,OAAQjC,EAAAC,EAAAC,cAAA,OAAKZ,GAAG,SAAS4C,MAAO,CAAEC,MAAO,iDAKzC,OAAI5E,KAAKK,MAAMwE,OACN,KAEPpC,EAAAC,EAAAC,cAAA,OAAKZ,GAAG,UACNU,EAAAC,EAAAC,cAAA,OAAKZ,GAAG,UACNU,EAAAC,EAAAC,cAAA,OAAKZ,GAAG,gBACRU,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,QAAMZ,GAAG,UAEXU,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,QAAMZ,GAAG,YAAT,wBADF,IAEkBU,EAAAC,EAAAC,cAAA,QAAMZ,GAAG,iBAAT,UAFlB,YAGkBU,EAAAC,EAAAC,cAAA,QAAMZ,GAAG,eAAT,YAChBU,EAAAC,EAAAC,cAAA,QAAMZ,GAAG,eAJX,MAKkBU,EAAAC,EAAAC,cAAA,QAAMZ,GAAG,UAL3B,UAMkBU,EAAAC,EAAAC,cAAA,QAAMZ,GAAG,gBAG7BU,EAAAC,EAAAC,cAAA,WAAKF,EAAAC,EAAAC,cAAA,KAAGZ,GAAG,gBAAN,iBACLU,EAAAC,EAAAC,cAAA,OAAKZ,GAAG,SAAS4C,MAAO,CAAEC,MAAO,4CAOrC,OACEnC,EAAAC,EAAAC,cAAA,OAAKZ,GAAG,WACNU,EAAAC,EAAAC,cAACmC,EAAA,EAAD,KACErC,EAAAC,EAAAC,cAACoC,EAAA,EAAD,KACG/E,KAAKgF,kBACLhF,KAAKiF,uBACLjF,KAAKK,MAAMU,OAEd0B,EAAAC,EAAAC,cAACuC,EAAA,EAAD,KACGlF,KAAKmF,eACLnF,KAAKoF,yBA/KIC,cAwLIA,YA+BX3F","file":"static/js/10.6ff7110d.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { Badge, Card, CardBody, CardHeader, Col, Pagination, PaginationItem, PaginationLink, Row, Table } from 'reactstrap';\r\nimport { Popover, PopoverBody, PopoverHeader, Alert, Button } from 'reactstrap';\r\nimport { Modal, ModalBody, ModalFooter, ModalHeader, Label, Input, InputGroup, InputGroupAddon, InputGroupText, FormGroup } from 'reactstrap'\r\nimport { loadLocalAccount, getCurrentHost, getFileHost, startPlayer } from '../js/gegeUtil.js'\r\nimport PopHint from '../../conponents/PopHint/PopHint'\r\nimport styles from './style.css';\r\nconst get = require('simple-get')\r\nconst randombytes = require('randombytes')\r\nvar sanitizeHtml = require('sanitize-html');\r\nclass NewsWeb extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.page = 1;\r\n    this.state = { list: [], page: 1, count: 0, paying: false, fee: '1', deadline: '5' }\r\n  }\r\n\r\n  componentDidMount() {\r\n    let hash = window.location.hash;\r\n    let query = null;\r\n    let title = '';\r\n    if (hash) {\r\n      let idx = hash.indexOf(\"#\", 1);\r\n      if (idx > 0) {\r\n        let needPay = hash.substr(idx + 66, 1);\r\n        title = hash.substr(idx + 66);\r\n        title = decodeURIComponent(title)\r\n        if (title) {\r\n          this.setState({ title, needPay })\r\n        }\r\n        query = hash.substr(idx + 1, 64);\r\n        idx = query.indexOf(\"#\", 1);\r\n        if (idx > 0) {\r\n          query = query.substr(0, idx);\r\n        }\r\n        //console.log('query=' + query);\r\n      }\r\n    }\r\n    setTimeout(() => {\r\n      var account = loadLocalAccount();\r\n      if (!account) {\r\n        account = { secret: 'anonymous' + new Date().toDateString() + '-' + Math.random() }\r\n      }\r\n      startPlayer(account.secret, { id: query, tags: title + '.html' })\r\n    }, 500);\r\n  }\r\n\r\n  loadIframe(peerId, newsId) {\r\n    var page = document.querySelector('#iframe')\r\n    var url = getFileHost() + '/html/' + peerId + '/' + newsId;\r\n    if (this.state.needPay) {\r\n      url = getFileHost() + '/priced/' + peerId + '/' + newsId;\r\n    }\r\n    page.innerHTML = \"<iframe width='100%' height='100%' frameborder='0' name='_blank' src='\" + url + \"' />\"\r\n  }\r\n\r\n  togglePurchase() {\r\n    this.setState({ paying: !this.state.paying })\r\n  }\r\n\r\n  doPurchase() {\r\n\r\n  }\r\n\r\n  renderPurchaseDialog() {\r\n    return (<Modal isOpen={this.state.paying} toggle={this.togglePurchase.bind(this)}\r\n      className={'modal-info ' + this.props.className}>\r\n      <ModalHeader toggle={this.togglePurchase.bind(this)}>支付朋友圈信息</ModalHeader>\r\n      <ModalBody>\r\n        <FormGroup>\r\n          <div className=\"controls\">\r\n            <InputGroup className=\"input-prepend\">\r\n              <InputGroupAddon addonType=\"prepend\">\r\n                <InputGroupText>{this.state.title}</InputGroupText>\r\n              </InputGroupAddon>\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        <FormGroup>\r\n          <div className=\"controls\">\r\n            <InputGroup className=\"input-prepend\">\r\n              <InputGroupAddon addonType=\"prepend\">\r\n                <InputGroupText>价格:</InputGroupText>\r\n              </InputGroupAddon>\r\n              <Input id=\"appendedPrependedInput\" size=\"16\" type=\"text\" value={1} />\r\n              <InputGroupAddon addonType=\"append\">\r\n                <InputGroupText>积分</InputGroupText>\r\n              </InputGroupAddon>\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        <FormGroup>\r\n          <div className=\"controls\">\r\n            <InputGroup className=\"input-prepend\">\r\n              <InputGroupAddon addonType=\"prepend\">\r\n                <InputGroupText><PopHint id=\"min123\" text='机器人费:' content='机器人为账户余额比较多的账户随机产生，负责验证所有交易是否符合规则,并将合法交易保存到区块链。机器人保证整个系统按照规则运行。同时获得机器人费。' /></InputGroupText>\r\n              </InputGroupAddon>\r\n              <Input id=\"appendedPrependedInput\" size=\"16\" type=\"text\" onChange={(fee) => this.setState({ fee })} placeholder='机器人费，最少0.1个' />\r\n              <InputGroupAddon addonType=\"append\">\r\n                <InputGroupText>积分</InputGroupText>\r\n              </InputGroupAddon>\r\n            </InputGroup>\r\n          </div>\r\n        </FormGroup>\r\n        {\r\n          this.renderDeadline()\r\n        }\r\n        <div>\r\n          <p>{this.state.purchaseMsg}</p>\r\n        </div>\r\n        <div className=\"form-actions\">\r\n          <Button type=\"submit\" color=\"primary\" onClick={(e) => this.doPurchase()}>购买</Button>\r\n          <Button color=\"secondary\" onClick={(e) => this.togglePurchase()}>取消</Button>\r\n        </div>\r\n      </ModalBody>\r\n    </Modal>)\r\n  }\r\n\r\n  renderDeadline() {\r\n    if (true)\r\n      return null;\r\n    return (<FormGroup>\r\n      <div className=\"controls\">\r\n        <InputGroup className=\"input-prepend\">\r\n          <InputGroupAddon addonType=\"prepend\">\r\n            <InputGroupText><PopHint id='dl4545' text='(有效期):' content='机器人验证交易时候会按手续费高低排序处理，有效期内未被处理的交易会被舍弃。交易作废。' /></InputGroupText>\r\n          </InputGroupAddon>\r\n          <Input id=\"appendedPrependedInput\" size=\"16\" onChange={(deadline) => this.setState({ deadline })} type=\"text\" placeholder='交易有效期，默认5分钟' />\r\n          <InputGroupAddon addonType=\"append\">\r\n            <InputGroupText>分钟</InputGroupText>\r\n          </InputGroupAddon>\r\n        </InputGroup>\r\n      </div>\r\n    </FormGroup>)\r\n  }\r\n\r\n  renderPayButton() {\r\n    if (this.state.needPay == 0)\r\n      return null;\r\n    return (<Alert color=\"primary\">收费朋友圈信息需要付费给作者后才可以查看全部内容。  <a href='https://github.com/btbresource/btb-android'>点击下载安卓客户端支付</a> </Alert>)\r\n  }\r\n\r\n  renderIframe() {\r\n    return (<div id=\"iframe\" style={{ width: '100%' }}>\r\n    </div>)\r\n  }\r\n\r\n  renderPlayer() {\r\n    if (this.state.iframe)\r\n      return null;\r\n    return (\r\n      <div id=\"status\">\r\n        <div id=\"output\">\r\n          <div id=\"progressBar\" />\r\n          <div>\r\n            <code id=\"tags\"></code>\r\n          </div>\r\n          <div>\r\n            <code id=\"numPeers\">0 peers(节点</code>.\r\n                            <code id=\"downloadSpeed\">0 b/s </code> / &#x2197;\r\n                            <code id=\"uploadSpeed\">0 b/s - </code>\r\n            <code id=\"downloaded\"></code> of\r\n                            <code id=\"total\"></code> —\r\n                            <span id=\"remaining\"></span>\r\n          </div>\r\n        </div>\r\n        <div><a id=\"downloadLink\">保存</a></div>\r\n        <div id=\"player\" style={{ width: '100%' }}>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div id=\"playdiv\">\r\n        <Card>\r\n          <CardHeader>\r\n            {this.renderPayButton()}\r\n            {this.renderPurchaseDialog()}\r\n            {this.state.title}\r\n          </CardHeader>\r\n          <CardBody>\r\n            {this.renderPlayer()}\r\n            {this.renderIframe()}\r\n          </CardBody>\r\n        </Card>\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass PopoverItem extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.toggle = this.toggle.bind(this);\r\n    this.state = {\r\n      popoverOpen: false\r\n    };\r\n  }\r\n\r\n  toggle() {\r\n    this.setState({\r\n      popoverOpen: !this.state.popoverOpen,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <span>\r\n        <span className='alert-primary  fade show' id={'Popover-' + this.props.id} onClick={this.toggle}>\r\n          (分享链接)\r\n        </span>\r\n        <Popover placement='top' isOpen={this.state.popoverOpen} target={'Popover-' + this.props.id} toggle={this.toggle}>\r\n          <PopoverHeader>分享这个资源的链接</PopoverHeader>\r\n          <PopoverBody>{getCurrentHost() + \"/#/btb#\" + this.props.res.id}</PopoverBody>\r\n        </Popover>\r\n      </span>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NewsWeb;\r\n"],"sourceRoot":""}